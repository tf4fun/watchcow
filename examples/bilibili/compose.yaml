services:
  bilibili:
    image: busybox:uclibc
    container_name: bilibili-redirect
    ports:
      - "3000:3000"
    volumes:
      - ./redirect.sh:/www/cgi-bin/index.cgi
    command: >
      sh -c "chmod +x /www/cgi-bin/index.cgi &&
             httpd -f -p 3000 -h /www"
    restart: unless-stopped
    stop_signal: SIGKILL  # 立即强制停止
    network_mode: bridge

    labels:
      # 启用 WatchCow 发现
      watchcow.enable: "true"

      # 应用标识 (对应 manifest.appname)
      watchcow.appname: "watchcow.bilibili"

      # 显示信息 (对应 manifest 字段)
      watchcow.display_name: "哔哩哔哩"
      watchcow.desc: "一键跳转到 B 站"
      watchcow.version: "1.0.0"
      watchcow.maintainer: "WatchCow"

      # 网络配置
      watchcow.service_port: "3000"
      watchcow.protocol: "http"
      watchcow.path: "/cgi-bin/index.cgi"

      # UI 配置
      watchcow.ui_type: "url"
      watchcow.icon: "https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/png/bilibili.png"
