<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WatchCow Dashboard</title>
    <style>{{.BulmaCSS}}</style>
    <style>
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 300px;
            overflow-y: auto;
            border-right: 1px solid #dbdbdb;
            background: #f5f5f5;
        }
        .main-content {
            margin-left: 300px;
            min-height: 100vh;
            padding: 1.5rem;
        }
        .container-item {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #dbdbdb;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .container-item:hover {
            background-color: #e8e8e8;
        }
        .container-item.is-selected {
            background-color: #3273dc;
            color: white;
        }
        .container-item.is-selected .tag {
            background-color: rgba(255,255,255,0.2);
            color: white;
        }
        .container-item.is-label-configured {
            opacity: 0.7;
        }
        .state-running { color: #48c774; }
        .state-stopped { color: #ffdd57; }
        .state-other { color: #f14668; }
        .icon-lock { margin-left: 0.5rem; }
        .icon-check { margin-left: 0.5rem; color: #48c774; }
        .htmx-request .htmx-indicator {
            display: inline-block;
        }
        .htmx-indicator {
            display: none;
        }
    </style>
    <script>{{.HtmxJS}}</script>
</head>
<body>
    <aside class="sidebar">
        <div class="p-4">
            <h1 class="title is-4">
                <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span>
                WatchCow
            </h1>
            <p class="subtitle is-6 has-text-grey">Container Configuration</p>
        </div>
        <div id="container-list" hx-get="containers" hx-trigger="load, every 10s" hx-swap="innerHTML">
            <div class="p-4 has-text-centered">
                <span class="htmx-indicator">Loading...</span>
            </div>
        </div>
    </aside>

    <main class="main-content">
        <div id="container-form">
            <article class="message is-info">
                <div class="message-body">
                    Select a container from the sidebar to configure it as an fnOS app.
                </div>
            </article>
        </div>
    </main>

    <script>
        // Preserve selection when list refreshes
        document.body.addEventListener('htmx:configRequest', function(evt) {
            if (evt.detail.path === 'containers') {
                var selected = document.querySelector('.container-item.is-selected');
                if (selected) {
                    evt.detail.parameters['selected'] = selected.dataset.id;
                }
            }
        });
    </script>
</body>
</html>
